# Example test vectors from:
# https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-224.ipd.pdf (Appendix B)
test_that("hmac-sha2-224", {

  # SHA-224
  # (tcid = 751)
  # key     670 176 E44E3C28 37D83501 BD5B5403 AF653DC6 08A2B217 689E
  # message 671 128 EA008790 F4F4BB46 93BD17FD 726517BE
  # tag     672 160 7D832AE4 6647B47A EEE26B65 F5F1E518 05C78F1E
  tag_len <- 160/8
  result <- HMAC_SHA2_224(wkb::hex2raw("E44E3C28 37D83501 BD5B5403 AF653DC6 08A2B217 689E"),
                          wkb::hex2raw("EA008790 F4F4BB46 93BD17FD 726517BE"))

  expect_equal(result[1:tag_len], wkb::hex2raw("7D832AE4 6647B47A EEE26B65 F5F1E518 05C78F1E"))
})

test_that("hmac-sha2-256", {
  # SHA-256
  # (tcid = 151)
  # key     673 136 C8D46CBF 65271FCC 60DB02E4 D7CC4BD8 75
  # message 674 128 063F0B6E 8960826C FBE35EBD B01B47EA
  # tag     675 128 6B800744 B38D0A9F 2B9D64C5 82F7D6D9
  tag_len <- 128/8
  result <- HMAC_SHA2_256(wkb::hex2raw("C8D46CBF 65271FCC 60DB02E4 D7CC4BD8 75"),
                          wkb::hex2raw("063F0B6E 8960826C FBE35EBD B01B47EA"))

  expect_equal(result[1:tag_len], wkb::hex2raw("6B800744 B38D0A9F 2B9D64C5 82F7D6D9"))
})

test_that("hmac-sha2-384", {
  # SHA-384
  # (tcid = 751)
  # key     676 448 D122EA65 7D8E3D5C 5B69C9FE 4AB7368D 508E500C 3EA2E528 D346547A
  #                 72987086 C97668B7 C139058A 3F454144 832FF7FF 31FFD48F 25936E3A
  # message 677 128 3933069E 5E5A5BB0 AAB68C3C 1F9FCAF7
  # tag     678  80 7DD24D9A E7A9D82E A6CA
  tag_len <- 80/8
  result <- HMAC_SHA2_384(wkb::hex2raw("D122EA65 7D8E3D5C 5B69C9FE 4AB7368D 508E500C 3EA2E528 D346547A 72987086 C97668B7 C139058A 3F454144 832FF7FF 31FFD48F 25936E3A"),
                          wkb::hex2raw("3933069E 5E5A5BB0 AAB68C3C 1F9FCAF7"))

  expect_equal(result[1:tag_len], wkb::hex2raw("7DD24D9A E7A9D82E A6CA"))
})

test_that("hmac-sha2-512", {
  # SHA-512
  # (tcid = 1)
  # key     679 384 F9E2E43A 5FBAB3E2 4FEC3A76 C2496883 70544FFA D051FE90 4531C3FE B66DE453 DF0A24BB D1B3A43C 34788732 651EBA8A
  # message 680 128 ED39A835 34D4D989 C6B25FA8 A563F51C
  # tag     681  80 7A047975 A81D30E9 CF18
  tag_len <- 80/8
  result <- HMAC_SHA2_512(wkb::hex2raw("F9E2E43A 5FBAB3E2 4FEC3A76 C2496883 70544FFA D051FE90 4531C3FE B66DE453 DF0A24BB D1B3A43C 34788732 651EBA8A"),
                          wkb::hex2raw("ED39A835 34D4D989 C6B25FA8 A563F51C"))

  expect_equal(result[1:tag_len], wkb::hex2raw("7A047975 A81D30E9 CF18"))
})


test_that("hmac-sha3-224", {
  # SHA3-224
  # (tcid = 1)
  # key     688 264 F8A7ED55 62A7646A 22B4DBB1 4D3AD891 CA677877 DAE37860 2F09CE47 9D3B11E8 1A
  # message 689 128 7627B19C B5559458 7EDAD2FF 0C22D292
  # tag     690  88 1AF28609 D217BF6D FB1184
  tag_len <- 88/8
  result <- HMAC_SHA3_224(wkb::hex2raw("F8A7ED55 62A7646A 22B4DBB1 4D3AD891 CA677877 DAE37860 2F09CE47 9D3B11E8 1A"),
                          wkb::hex2raw("7627B19C B5559458 7EDAD2FF 0C22D292"))

  expect_equal(result[1:tag_len], wkb::hex2raw("1AF28609 D217BF6D FB1184"))
})

test_that("hmac-sha3-256", {
  # SHA3-256
  # (tcid = 526)
  # key     691 264 5F712D90 E610531A A24E2C5C B59B2B7F 0E1D2298 09B10F46 201E48D4 93EB6784 EC
  # message 692 128 6D95CE1D ECC2212A F7B33A90 D6297E02
  # tag     693 160 ED29D0D3 923524AE 417F0B30 DFF8A412 8DC202AE
  tag_len <- 160/8
  result <- HMAC_SHA3_256(wkb::hex2raw("5F712D90 E610531A A24E2C5C B59B2B7F 0E1D2298 09B10F46 201E48D4 93EB6784 EC"),
                          wkb::hex2raw("6D95CE1D ECC2212A F7B33A90 D6297E02"))

  expect_equal(result[1:tag_len], wkb::hex2raw("ED29D0D3 923524AE 417F0B30 DFF8A412 8DC202AE"))
})

test_that("hmac-sha3-384", {
  # SHA3-384
  # (tcid = 601)
  # key     694 584 63E7020D 5E017AA8 F86618BA 4A4ED4BE 03298E92 BA8EF97C 7396D260 61B12D5D
  #                 638C3E53 FF1B8052 B5E217A9 27EB7D9B 80CEDAC1 CEB227A1 3A0229DF 542F8B0F
  #                 1040A5C8 E9558CDD EB
  # message 695 128 C4222888 AFAB77E7 C9206D28 94714E9A
  # tag     696 160 0B546DF3 EF91E1DA 09E5E7EF C7258CA2 DA57CBE6
  tag_len <- 160/8
  result <- HMAC_SHA3_384(wkb::hex2raw("63E7020D 5E017AA8 F86618BA 4A4ED4BE 03298E92 BA8EF97C 7396D260 61B12D5D
                                        638C3E53 FF1B8052 B5E217A9 27EB7D9B 80CEDAC1 CEB227A1 3A0229DF 542F8B0F
                                        1040A5C8 E9558CDD EB"),
                          wkb::hex2raw("C4222888 AFAB77E7 C9206D28 94714E9A"))

  expect_equal(result[1:tag_len], wkb::hex2raw("0B546DF3 EF91E1DA 09E5E7EF C7258CA2 DA57CBE6"))
})

test_that("hmac-sha3-512", {
  # SHA3-512
  # (tcid = 76)
  # key     697 384 A471B461 43C47722 A4317F79 C3605F56 06210066 F7607F37 BFC05AB4 8AD624EC DDAA5F2B CE0F5D68 CB900A94 041A388C
  # message 698 128 676498A9 15CC5B77 3275034A 972B552A
  # tag     699 152 CF38AA4B 510886A3 4FB3B67F 50F8FED5 9DE585
  tag_len <- 152/8
  result <- HMAC_SHA3_512(wkb::hex2raw("A471B461 43C47722 A4317F79 C3605F56 06210066 F7607F37 BFC05AB4 8AD624EC DDAA5F2B CE0F5D68 CB900A94 041A388C"),
                          wkb::hex2raw("676498A9 15CC5B77 3275034A 972B552A"))

  expect_equal(result[1:tag_len], wkb::hex2raw("CF38AA4B 510886A3 4FB3B67F 50F8FED5 9DE585"))
})
